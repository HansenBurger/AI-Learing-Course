# 图像滤波

## 一、图像噪声

图像噪声是在图像获取或者传输过程中受到随机信号干扰，妨碍人们对图像理解及分析处理的信号

图像噪声的产生来自图像获取的环境条件和传感元器件自身质量，图像在传输过程中产生图像噪声的主要原因是所用传输信道收到噪声的污染

(有时候需要人为的加入噪声, 比如添加马赛克)

### 1.1 高斯噪声

概率密度分布服从高斯分布的噪声

噪声幅度服从高斯分布，任意两个采样样本不相关(所有噪声都不相关)，则称他为高斯白噪声

区分**高斯噪声和白噪声概念不同**, 白噪声不必服从高斯分布, 高斯分布的噪声也不一定是白噪声

原因:
    1. 图像传感器在拍摄时不够明亮, 亮度不够均匀
    2. 电路元器件自身噪声相互影响
    3. 图像传感器长期工作，温度过高

P_out = P_in + random.gauss

random.gauss 通过sigma和mean产生符合高斯分布的随机数

过程:
    1. 输入参数sigma和mean
    2. 生成高斯随机数
    3. 根据属兔像素值计算出输出像素
    4. 重新将所有像素值缩放0-255
    5. 循环所有像素(根据需求来，选取像素添加噪声)
    6. 输出图像

代码:
    1. 输入加噪像素的范围
    2. 随机确定像素的位置
    3. 增加高斯噪声

### 1.2 椒盐噪声

椒盐噪声又称脉冲噪声, 随机出现的白点或者黑点

椒盐噪声 = pepper noise (0, 黑) + salt noise (255, 白)

两者同时出现, 呈现在图像上是黑白杂点

对于彩色图像, 也可能表现为单个像素BGR三个通道随机出现255或者0

原因:
    1. 部分像素值在传输时丢失, 就会产生这种噪声
    2. 影像讯号收到突如其来的强烈干扰产生, 失效的感应器-0, 饱和的感应器-255

添加可能是为了保密, 也是为了不让人看清楚, 或者专门的图像效果

过程:
    1. 指定信噪比SNR, 取值范围在[0,1]
    2. 计算总像素数目SP, 加噪的像素数目NP = SP * SNR
    3. 随机获得需要加噪的每个像素位置P(i,j)
    4. 指定像素值为255 或者 0
    5. 重复3-4

## 二、图像滤波

1. 图像滤波, 在尽量保留图像细节特征的条件下对目标图像噪声进行抑制, 是图像预处理中不可缺少的操作
2. 信号和图像的能量大部分在中频和低频, 再较高频, 因此一个能降低高频成分幅度的滤波器能减弱噪声的影响
3. 平滑滤波**低频增强的空间滤波技术**, 目的: 1.模糊, 2.消除噪声。
4. 滤波器想象为一个包换加权系数的窗口, 当使用这个滤波器平滑处理图像时, 把窗口放在图像之上

目的:
    1. 消除图像中混入的噪声
    2. 为图像识别抽取出图像特征

要求:
    1. 不能损坏图像轮廓及边缘
    2. 图像视觉效果应当更好

滤波要满足对图像处理的要求

傅里叶变换也是在图像滤波中

## 三、各种滤波器

### 3.1 均值滤波

用每个像素和周围像素计算平均值替换像素

注意: **加权求和之后还要除以9才是均值**, 用均值替换蓝色中心像素

参数: 1. 迭代次数(↑, 效果更好), kernal大小(更大整体更好)

边缘滤波需要加入padding

优点: 算法简单, 计算速度快
缺点: 降低噪声同时图像产生模糊, 特别是物边缘和细节(**大部分滤波都有这个缺点**)

### 3.2 中值滤波

中值滤波(针对不同噪声, 选用不同滤波方法), 中值滤波效果比均值滤波更好。

将周围像素和中心像素排序后, 取中值

均值滤波--高斯噪声, 中值滤波(不会取到最大最小, 一定会取到中间的值)--椒盐噪声、

### 3.3 最大最小值滤波

中心值比周围最大值大: 取周围最大值, 中心值比周围最小值小: 取周围最小值

保守的图像处理手段

多个滤波手段可以叠加使用

## 四、图像增强

有目的的强调图像的整体或局部特征, 将原来不清晰的图像变得清晰或者强调默写感兴趣的特征

分类:
    1. 点处理技术(只对单个像素进行处理)
    2. 领域处理技术(对像素点及周围点进行处理)，使用卷积核

图像增强, 会使得训练数据集更多, 可以通过对图像处理产生更多新的图像(**深度学习扩充数据集**)

### 4.1 点处理

#### 4.1.1 图像线性变换

$
y = a*x +b
$

a > 1: 增加图像对比度(像素之间差异)
a < 1：减小图像对比度, 更模糊
a = 1, b > 0: 图像变亮 (对比度不变)
a = 1, b < 0: 图像变暗

#### 4.1.2 分段线性变换

对于某个感兴趣区域x, 对比度系数增大减小改变局部对比度

#### 4.1.3 对数变化

$y=c*log(1+x)$

将图像的低灰度值扩展, 高灰度值压缩, 突出细节

原理就是log函数在低取值范围变化快, 高取值范围变化慢

对数变换的底数没有要求, 整体变换趋势一致

#### 4.1.4 幂律变换/伽马变换

$y=c*x^γ$

γ > 1: 处理漂白图像, 进行灰度级压缩

γ < 1: 处理过黑图片, 对比度增强, 细节看的更清楚

x: 像素值

可以在处理后再进行一个缩放

### 4.2 图像增强的常用方法

1. 翻转、平移、旋转、缩放
2. 分离单个rgb通道
3. 添加噪声
4. 直方图均衡化
5. Gamma变换
6. 反转图像灰度
7. 增加图像对比度
8. 缩放图像灰度
9. 均值滤波
10. 中值滤波
11. 高斯滤波

增强和减弱对立统一
