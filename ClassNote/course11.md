# 尺度不变特征变换(SIFT)

图像拼接技术

## SIFT

提取图像的局部特征, **在尺度空间寻找极值点, 提取位置尺度方向信息**

(比一般图像只看位置和灰度特征不同)

应用: 物体辨别, 机器人地图感知和导航, 手势识别, 影像追踪

特点:
    1. 旋转, 尺度缩放, 亮度变化保持不变性(对视角变化, 噪声也存在稳定性)
    2. 独特性, 信息量丰富, 适用于在海量特征数据中进行快速准确匹配
    3. 多量性, 即使少数几个物体也可以产生大量sift特征向量
    4. 可扩展性, 可以很方便的与其他形式的特征向量进行联合

Sift:
    1. 特征点检测, 2. 特征点描述， 3. 两个目标特征点集 4. 匹配

sift有专利, opencv > 3.4.3中不再提供

### 1. 匹配步骤

1. 生成**高斯** **差分** **金字塔**(DOG金字塔), 尺度空间构建
2. 空间极值点检测

#### 1.1. SIFT -- 尺度空间

尺度的大小, 决定了观察的仔细程度(用机器来模拟人眼)

尺度空间: 在图像领域模拟人眼观察物体的概念与方法(观察局部, 则观察局部特征; 观察整体, 则大尺度观察去除细节)

#### 1.2. SIFT -- 图像金字塔

用多种分辨率来解释图像的结构，通过原始图像进行多尺度像素排列(传统: 顶部只包含一个像素)

步骤:
    1. 利用滤波器平滑图像(高斯滤波)
    2. 对平滑图像进行抽样

两种采样方式: 上采样(分辨率逐级升高), 下采样(分辨率逐级下降) 各种插值方法

#### 1.3. SIFT -- 高斯金字塔

通过高斯滤波检测出轮廓的金子塔(主轮廓作一个特征向量, 实现边缘角点检测不同分辨率上的关键点)

很多组金子塔, 且每组(个)金子塔有很多层

构建过程:
    1. 先将原图像扩大一倍(实验科学)作为1组1层， 再将1组1层高斯卷积(滤波)作为1组金字塔的2层
    2. 将σ乘以k(比例系数), 得到平滑因子 $σ=k*σ$ 用来平滑第一组的第二层, 作为第三层
    3. 得到L层图像, 每层图像**尺寸一样**(需要padding), 平滑系数不同: 0, σ, k幂次σ, ... , $k^(L-2)σ$
    4. 第一组倒数第三层尺寸减半, 作为2组第一层。**尺寸第2组是第1组图像的一半**

反复执行, 得到一共O组, 每组L层, 共计L*O个图像, 构成高斯金字塔

> 1. 同一组内, 不同层图像尺寸一样, 后一层高斯平滑因子为前一层的k倍
> 2. 不同组间, 后一组的第一个图像是前一组倒数第三个图像的二分之一采样, 图像大小是前一组的一半

#### 1.4. SIFT -- 尺度空间

给定一组O(组数)L(层数), 就能确定高斯金子塔中的一副图像, 即尺度空间

不需要在内存中存储成一个金子塔结构

L(x,y,σ) 原始图像(x, y)与一个可变尺度2维高斯函数G(x,y)

#### 1.5. SIFT -- DOG金字塔

差分金子塔: 第o组的

不同尺度下不同轮廓信息, 差分来提取特征

(做差, 去除背景)

### 2. 尺度空间极值检测

特征点是由DOG的空间局部极值点组成的(需要和它所有相邻点进行比较, 看是否比相邻点更大或者更小)

**注意**: 局部极值点是在同一个组中进行的, 某一个组的第一个和最后一个图层不存在前一张和后一张, 利用高斯模糊多出三张凑数, DOG中多两张

### 2. 高斯金字塔k值

$k=2^1/2$ 大于1小于2的数

σ大约取得1.6

s: 每组图像中检测s个尺度(多出的不需要判断极值点)的极值点, s通常3-5

每一个尺度的极值点不唯一

S: 高斯差分金子塔的层数

高斯金字塔有O组, 每组有S+3层

$O = log_2(min{M,N}) - 3$ 行列最小值对数-3

> s的意思是将来我们在差分金子塔中求极值点, 要求s层点(一层一个极值点)

一组要检测的尺度的极值点,s=5的话, L=8(S+3)

L(高斯金字塔层数)根据需求反推

### 3. SIFT -- 稳定关键点的精确定位

利用单阈值实现精度更高的优化项

### 4. SIFT -- 稳定关键点方向信息分配

获取关键点所在尺度空间的领域, 计算该区域的梯度和方向, 根据计算得到的结果创建方向直方图

峰值: 主方向(梯度方向)参数
辅助方向: 高于主方向80%的方向

### 5. SIFT -- 关键点描述

每个关键点, 都有位置、尺度和方向(梯度方向)三个信息

每一个关键点, 都有2*2*8(方向) 向量, 用4*4效果更优

### 6. SIFT -- 特征点匹配

计算两组特征点128维的关键点的欧式距离

欧式距离越小, 相似度越高, 欧式距离小于阈值, 可以判断维匹配成功

特征匹配的方法很多
