# 边缘提取

## 一、边缘提取

边缘: 灰度值在很小的缓冲区域内急剧变化到另一个灰度相差较大的灰度值

边缘**有正负之分，由暗到亮为正，由亮到暗为负**

sobel、prewitt、laplace、Canny(效果最好，实现麻烦)

### 1.1 定义

边缘检测就是图像的灰度变化的度量、检测和定位

### 1.2 高频/低频信号

高频分量: 图像强度(亮度/灰度)变化剧烈的地方，即边缘

低频分量: 图像强度(亮度/灰度)变化平缓的地方，即大片色块

特点:**人眼对图像中的高频信号更为敏感**

### 1.3 边缘检测步骤、原理

#### 1.3.1 步骤

1. 滤波: 边缘检测基于一阶二阶导数，导数对噪声敏感，须采用滤波器来改善性能(高斯滤波)

2. 增强: 增强将图像灰度点邻域强度值由显著变化的点凸显出来(计算梯度幅值)

3. 检测: 对边缘点进行取舍(阈值化方法检测)

#### 1.3.2 原理

一阶导数为极值，二阶导数为0，就可以进行边缘检测(图像归一化后连续)

## 二、图像锐化

图像锐化为了突出图像上的边缘，**边缘增强**

常用的为拉普拉苏变换核函数(放大中心点和周围点的差异)

## 三、Prewitt、Sobel 算子

图像平滑为了突出图像宽大区域，抑制图像噪声和干扰高频成分

sobel局部平均，对于噪声具有平滑作用

## 四、Canny算法

Canny 是目前最优秀的边缘检测算法之一，其目标为了找到一个最优边缘

最优边缘:
    1. 好的检测(尽可能标出实际边缘)
    2. 好的定位(标识出的边缘与实际边缘尽可能接近)
    3. 最小响应(边缘只能标记一次)

### 4.1 步骤

1. 图像灰度化(边缘不区分RGB)

2. 图像高斯滤波: 滤除掉图像高频噪声

3. 检测图像中水平、垂直和对角边缘

4. 对梯度幅值进行非极大值抑制: 找到局部最大值，非极大值灰度0

5. 用双阈值算法检测和连接边缘

### 4.2 高斯平滑

使得卷积核呈现高斯分布, 卷积核的大小选择影响Canny检测器性能(尺寸越大，敏感度越低)

原因: **边缘的灵敏度和噪声的灵敏度同源** 一般5X5是一个比较不错的trade off(抗噪声干扰和边缘检测)

### 4.3 非极大值抑制

NMS: **搜索局部最大值，抑制非极大值**

> NMS算法在不同应用中的具体实现不一样，思想一样

使用NMS原因: 目标检测会在同一位置出现大量候选框，可能重叠，用NMS找到最佳边界框，消除冗余边界框

1. 将当前像素的梯度强度与沿正负梯度方向的两个像素进行比较

2. 如当前点比梯度方向上两点值大，保留，否则抑制(tmp1, tmp2使用插值计算)

三选一

### 4.4 双阈值检测

完成非极大值抑制，非边缘点均为0，边缘点值(不固定)，但还是可能包含假边缘

梯度高于高阈值: 强边缘
低阈值 < 梯度 < 高阈值: 弱边缘
梯度小于低阈值: 抑制

弱边缘的抑制还是归于强边缘根据实验和经验需求

对于弱边缘: 需要再次筛选
